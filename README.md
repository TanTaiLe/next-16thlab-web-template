This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.

---

# B∆∞·ªõc 1:T·∫°o project Next.js + TypeScript + Tailwind v·ªõi Yarn

## 1. T·∫°o project Next.js m·ªõi (TypeScript)

```bash
yarn create next-app next-16thlab-web-template --typescript --eslint
```

- `--typescript`: b·∫≠t TypeScript ngay t·ª´ ƒë·∫ßu
- `--eslint`: th√™m ESLint config m·∫∑c ƒë·ªãnh

## 2. C√†i ƒë·∫∑t Tailwind CSS (v3)

```bash
cd next-16thlab-web-template
yarn add -D tailwindcss@^3 postcss autoprefixer
npx tailwindcss init -p
```

- `@^3` v3 s·∫Ω h·ªó tr·ª£ ƒë∆∞·ª£c c·∫£ nh·ªØng tr√¨nh duy·ªát c≈©
- `-D`: c√†i ƒë·∫∑t package v√†o devDependencies
- `postcss`: ti·ªÅn x·ª≠ l√Ω CSS
- `autoprefixer`: t·ª± ƒë·ªông th√™m prefix cho c√°c thu·ªôc t√≠nh CSS
- `-p`: t·ª± ƒë·ªông t·∫°o ra 2 file `tailwind.config.js` v√† `postcss.config.js`

## 3. C·∫•u h√¨nh Tailwind v3

üìå M·ªü file `tailwind.config.js` ‚Üí s·ª≠a n·ªôi dung:

```js
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./app/**/*.{js,ts,jsx,tsx,mdx}",
    "./pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./components/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
    extend: {},
  },
  plugins: [],
};
```

## 4. Th√™m CSS base c·ªßa Tailwind

M·ªü `src/app/globals.css` (Next.js 13+) ho·∫∑c `styles/globals.css` (n·∫øu `pages` router) ‚Üí th√™m:

```css
@tailwind base;
@tailwind components;
@tailwind utilities;
```

·ªû b∆∞·ªõc n√†y th∆∞·ªùng `VSCode/IDE` s·∫Ω b√°o `@tailwind` kh√¥ng nh·∫≠n di·ªán ƒë∆∞·ª£c - `Unknown at rule @tailwindcss(unknownAtRules)` (th·ª±c ra build v·∫´n ch·∫°y b√¨nh th∆∞·ªùng). ƒê√¢y l√† l·ªói t·ª´ `CSS IntelliSense` (c·ªßa `PostCSS/VSCode`). C√°ch fix nh∆∞ sau üëá:

Trong th∆∞ m·ª•c g·ªëc c·ªßa project, t·∫°o (ho·∫∑c m·ªü) file:
`.vscode/settings.json` v√† th√™m n·ªôi dung:

```json
{
  "css.validate": false,
  "tailwindCSS.experimental.classRegex": [
    ["clsx\\(([^)]*)\\)", "(?:'|\"|`)([^'\"`]*)(?:'|\"|`)"],
    ["cva\\(([^)]*)\\)", "(?:'|\"|`)([^'\"`]*)(?:'|\"|`)"]
  ]
}
```

- `"css.validate": false` ‚Üí t·∫Øt check CSS m·∫∑c ƒë·ªãnh.
- Sau ƒë√≥, VSCode s·∫Ω d√πng Tailwind IntelliSense extension ƒë·ªÉ hi·ªÉu `@tailwind`.

B√™n c·∫°nh ƒë√≥ h√£y ƒë·∫£m b·∫£o r·∫±ng b·∫°n ƒë√£ c√†i extension `Tailwind CSS IntelliSense` (n·∫øu ch∆∞a c√≥).

# B∆∞·ªõc 2: Setup ESLint + Prettier

## 1. C√†i Prettier v√† plugin c·∫ßn thi·∫øt

```bash
yarn add -D prettier eslint-config-prettier eslint-plugin-prettier

```

- `prettier`: ƒë·ªãnh d·∫°ng code
- `eslint-config-prettier`: t·∫Øt c√°c rule c·ªßa ESLint xung ƒë·ªôt v·ªõi Prettier
- `eslint-plugin-prettier`: th√™m rule Prettier v√†o ESLint

## 2. T·∫°o file c·∫•u h√¨nh Prettier

üìå T·∫°o file `.prettierrc.json` ·ªü root:

```json
{
  "semi": true,
  "singleQuote": true,
  "trailingComma": "es5",
  "tabWidth": 2,
  "printWidth": 100
}
```

- `semi: true`: lu√¥n c√≥ d·∫•u `;`
- `singleQuote: true`: d√πng `' '` thay v√¨ `" "`
- `trailingComma: es5`: th√™m d·∫•u `,` cu·ªëi object/array n·∫øu c·∫ßn
- `tabWidth: 2`: 2 space thay v√¨ tab
- `printWidth: 100`: ƒë·ªô d√†i t·ªëi ƒëa c·ªßa m·ªôt d√≤ng code l√† 100 k√Ω t·ª±

## 3. T·∫°o file c·∫•u h√¨nh ESLint

üìå T·∫°o file `.eslintrc.json` ·ªü root:

```json
{
  "extends": ["next/core-web-vitals", "plugin:prettier/recommended"],
  "plugins": ["prettier"],
  "rules": {
    "prettier/prettier": [
      "error",
      {
        "semi": true,
        "singleQuote": true,
        "trailingComma": "es5",
        "tabWidth": 2,
        "printWidth": 100
      }
    ]
  }
}
```

## 4. Th√™m script v√†o package.json

üìå Trong file `package.json` ·ªü root, th√™m ·ªü ph·∫ßn `scripts`:

```json
"scripts": {
  "lint": "next lint",
  "format": "prettier --write ."
}
```

- `yarn lint`: ch·∫°y ESLint
- `yarn format`: ƒë·ªãnh d·∫°ng code b·∫±ng Prettier

## 5. C·∫•u h√¨nh VSCode

üìå Trong file `.vscode/settings.json` (t·∫°o n·∫øu ch∆∞a c√≥), th√™m:

```json
{
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.formatOnSave": true
}
```

- `editor.defaultFormatter`: ƒë·ªãnh d·∫°ng code m·∫∑c ƒë·ªãnh l√† Prettier
- `editor.formatOnSave`: ƒë·ªãnh d·∫°ng code khi l∆∞u file

# B∆∞·ªõc 3: Setup Supabase + Prisma ORM

## 1. T·∫°o project Supabase

C√≥ 2 c√°ch:

- Cloud (ƒë∆°n gi·∫£n nh·∫•t): v√†o https://supabase.com
  , ƒëƒÉng k√Ω ‚Üí t·∫°o project Postgres mi·ªÖn ph√≠
- Local (n·∫øu mu·ªën ch·∫°y offline):

```bash
npx supabase init
supabase start
```

(Ch·∫°y b·∫±ng Docker)

üìå Sau khi c√≥ project, Supabase cung c·∫•p cho b·∫°n:

- `DB URL` (Postgres connection string) n·∫±m ·ªü `navigation bar` > button `Connect` n·∫±m c·∫°nh `main Production`
- `anon key` v√† `service_role key` (cho API auth) n·∫±m ·ªü `Project Settings` > `API Keys`

## 2. C√†i Prisma & client Supabase

üìå Trong root:

```bash
yarn add @prisma/client
yarn add -D prisma
```

- `@prisma/client`: client Prisma
- `-D prisma`: CLI Prisma (ch·ªâ c·∫ßn trong dev)

## 3. C·∫•u h√¨nh Prisma

```bash
npx prisma init
```

- T·∫°o file `prisma/schema.prisma` (ch·ª©a c·∫•u h√¨nh DB)
- T·∫°o file `.env` (ch·ª©a c√°c bi·∫øn m√¥i tr∆∞·ªùng) v·ªõi bi·∫øn `DATABASE_URL`

## 4. K·∫øt n·ªëi Supabase v·ªõi Prisma

M·ªü file .env v√† d√°n connection string c·ªßa Supabase:

```env
DATABASE_URL="postgresql://postgres:[PASSWORD]@[HOST]:5432/postgres"
```

V√≠ d·ª•: `postgresql://postgres:T@ntai1412#@db.cltzzjtyxcwyayiaqnhs.supabase.co:5432/postgres`

## 5. Khai b√°o schema v·ªõi Prisma

V√≠ d·ª• b·∫°n mu·ªën c√≥ b·∫£ng `User`:

üìÇ prisma/schema.prisma

```prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  name      String?
  createdAt DateTime @default(now())
}
```

## 6. Ch·∫°y migration & generate Prisma Client

```bash
npx prisma migrate dev --name init
```

üëâ Prisma s·∫Ω:

- T·∫°o b·∫£ng trong Supabase DB
- Sinh Prisma Client ƒë·ªÉ b·∫°n g·ªçi trong code

## 7. D√πng Prisma trong Next.js

T·∫°o file helper üìÇ `src/lib/prisma.ts`

```ts
import { PrismaClient } from "@prisma/client";

const globalForPrisma = global as unknown as { prisma: PrismaClient };

export const prisma =
  globalForPrisma.prisma ||
  new PrismaClient({
    log: ["query", "info", "warn", "error"],
  });

if (process.env.NODE_ENV !== "production") globalForPrisma.prisma = prisma;
```

## 8. T·∫°o API route th·ª≠ nghi·ªám

üìÇ `src/app/api/users/route.ts` (Next.js 13 App Router)

```ts
import { NextResponse } from "next/server";
import { prisma } from "@/lib/prisma";

export async function GET() {
  const users = await prisma.user.findMany();
  return NextResponse.json(users);
}
```

Sau ƒë√≥ ch·∫°y project:

```bash
yarn dev
```

V√† truy c·∫≠p API:

```bash
http://localhost:3000/api/users
```

üëâ Ta s·∫Ω th·∫•y danh s√°ch users trong DB (tr·ªëng ban ƒë·∫ßu)

‚úÖ V·∫≠y l√† b·∫°n ƒë√£ k·∫øt n·ªëi th√†nh c√¥ng Next.js ‚Üî Prisma ‚Üî Supabase üéâ

# B∆∞·ªõc 4: Setup Jest + React Testing Library

## 1. C√†i ƒë·∫∑t dependency

```bash
yarn add -D jest @types/jest ts-jest jest-environment-jsdom @testing-library/react @testing-library/jest-dom @testing-library/user-event
```

- `jest` ‚Üí test runner
- `ts-jest + @types/jest` ‚Üí h·ªó tr·ª£ TypeScript
- `jest-environment-jsdom` ‚Üí gi·∫£ l·∫≠p DOM cho test React
- `@testing-library/react` ‚Üí render & test component React
- `@testing-library/jest-dom` ‚Üí matcher b·ªï sung (toBeInTheDocument, toHaveTextContent ‚Ä¶)
- `@testing-library/user-event` ‚Üí gi·∫£ l·∫≠p thao t√°c user (click, type, tab ‚Ä¶)

## 2. T·∫°o file c·∫•u h√¨nh Jest

T·∫°o file `jest.config.js` ·ªü root:

```ts
import nextJest from "next/jest";

const createJestConfig = nextJest({
  dir: "./", // th∆∞ m·ª•c root c·ªßa Next.js app
});

const customJestConfig = {
  preset: "ts-jest",
  moduleDirectories: ["node_modules", "<rootDir>/"],
  testEnvironment: "jest-environment-jsdom",
  moduleNameMapper: {
    "^@/(.*)$": "<rootDir>/$1", // alias @/ tr·ªè v·ªÅ th∆∞ m·ª•c g·ªëc
  },
  setupFilesAfterEnv: ["<rootDir>/jest.setup.ts"],
  moduleFileExtensions: ["ts", "tsx", "js", "jsx", "json", "node"],
};

export default createJestConfig(customJestConfig);
```

- `preset: 'ts-jest'`: d√πng ts-jest ƒë·ªÉ bi√™n d·ªãch TypeScript
- `moduleDirectories`: t√¨m module trong c√°c th∆∞ m·ª•c n√†y
- `testEnvironment: 'jest-environment-jsdom'`: gi·∫£ l·∫≠p DOM cho test React
- `moduleNameMapper`: alias `@/` tr·ªè v·ªÅ th∆∞ m·ª•c g·ªëc
- `setupFilesAfterEnv`: ch·∫°y file setup Jest tr∆∞·ªõc khi ch·∫°y test
- `moduleFileExtensions`: c√°c ƒëu√¥i file ƒë∆∞·ª£c ph√©p

## 3. T·∫°o file setup Jest

T·∫°o file `jest.setup.ts` ·ªü root:

```ts
import "@testing-library/jest-dom";
```

üëâ D√πng ƒë·ªÉ import matcher b·ªï sung cho Jest

## 4. Th√™m script v√†o package.json

```json
"scripts": {
  "dev": "next dev",
  "build": "next build",
  "start": "next start",
  "lint": "next lint",
  "format": "prettier --write .",
  "test": "jest --watch"
}
```

## 5. Vi·∫øt test ƒë∆°n gi·∫£n

üìÇ `components/Hello.test.tsx`

```tsx
import { render, screen } from "@testing-library/react";
import React from "react";

function Hello() {
  return <h1>Hello 16thLab</h1>;
}

describe("Hello component", () => {
  it("renders correctly", () => {
    render(<Hello />);
    expect(screen.getByText("Hello 16thLab")).toBeInTheDocument();
  });
});
```

- `describe`: nh√≥m test
- `it`: 1 test case
- `render`: render component
- `screen`: truy c·∫≠p DOM
- `expect`: vi·∫øt test
- `getByText`: query DOM
- `toBeInTheDocument`: matcher b·ªï sung t·ª´ `@testing-library/jest-dom`

Sau ƒë√≥ ch·∫°y test:

```bash
yarn test
```

üëâ Ta s·∫Ω th·∫•y test passed üéâ

VD cho 1 k·∫øt qu·∫£ passed:

```bash
 PASS  components/Hello.test.tsx
  Hello component
    ‚àö renders correctly (31 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.054 s
```

# B∆∞·ªõc 5: Setup CI/CD v·ªõi Vercel

- M·ªói l·∫ßn push code ‚Üí t·ª± ƒë·ªông ch·∫°y lint + test
- N·∫øu pass ‚Üí Vercel s·∫Ω deploy Preview/Production
- N·∫øu fail ‚Üí ch·∫∑n deploy

## 1. Deploy project l√™n Vercel

1. Push code l√™n GitHub/GitLab/Bitbucket (Vercel h·ªó tr·ª£ c·∫£ 3).
2. V√†o https://vercel.com, login b·∫±ng GitHub (ho·∫∑c GitLab).
3. ·ªû ph·∫ßn `Import Git Repository` ti·∫øn h√†nh ch·ªçn project repositories m√† b·∫°n c·∫ßn (c√≥ th·ªÉ ch·ªçn t·∫•t c·∫£ ho·∫∑c ch·ªâ ƒë·ªãnh 1 v√†i repo).
4. Sau khi ch·ªçn b·∫°n s·∫Ω th·∫•y project v·ª´a th√™m v√†o v√† Vercel s·∫Ω t·ª± detect project l√† Next.js, b·∫•m `Import`.
5. ·ªû m·ª•c `Environment Variables` ‚Üí th√™m Key v√† Value cho `DATABASE_URL` (chu·ªói Supabase ƒë√£ encode).
6. B·∫•m `Deploy` ‚Üí Vercel s·∫Ω build v√† deploy l·∫ßn ƒë·∫ßu.

ƒê·ªëi v·ªõi l·∫ßn ƒë·∫ßu deply, ta s·∫Ω g·∫∑p l·ªói:

```bash
Collecting page data ...Error: @prisma/client did not initialize yet. Please run "prisma generate" and try to import it again.
...
> Build error occurred [Error: Failed to collect page data for /api/users] { type: 'Error' }
```

L·ªói n√†y xu·∫•t ph√°t t·ª´ `Prisma client` ch∆∞a ƒë∆∞·ª£c generate n√™n Next.js kh√¥ng import ƒë∆∞·ª£c `@prisma/client`. Gi·∫£i ph√°p x·ª≠ l√Ω:

```bash
yarn prisma generate
```

ƒêi·ªÅu n√†y s·∫Ω t·∫°o th∆∞ m·ª•c `.prisma` v√† c·∫≠p nh·∫≠t `node_modules/@prisma/client` d·ª±a tr√™n `schema.prisma`.

C·∫≠p nh·∫≠t l·∫°i file `app/api/users/route.ts`, b·∫°n ch·∫Øc ch·∫Øn ph·∫£i import Prisma client t·ª´ th∆∞ vi·ªán:

```ts
import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

export async function GET() {
  const users = await prisma.user.findMany();
  return Response.json(users);
}
```

V√† deploy l·∫°i l·∫ßn n·ªØa.

## 2. T√≠ch h·ª£p lint + test v√†o pipeline CI/CD c·ªßa Vercel

### ‚ö° C√°ch 1: D√πng Vercel‚Äôs "Build Command" (ƒë∆°n gi·∫£n nh·∫•t)

1. V√†o Settings ‚Üí Build and Development.
2. S·ª≠a Build Command t·ª´:

```bash
next build
```

th√†nh:

```bash
yarn lint && yarn test && next build
```

üëâ N·∫øu lint/test fail ‚Üí build fail ‚Üí Vercel kh√¥ng deploy.

### ‚ö° C√°ch 2: D√πng GitHub Actions (chuy√™n nghi·ªáp h∆°n)

N·∫øu mu·ªën ch·∫°y lint/test tr∆∞·ªõc c·∫£ khi Vercel build, b·∫°n t·∫°o CI workflow trong repo:
üìÇ `.github/workflows/ci.yml`

```yaml
name: CI

on:
  pull_request:
  push:
    branches: [main]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18
          cache: "yarn"

      - name: Install dependencies
        run: yarn install --frozen-lockfile

      - name: Run lint
        run: yarn lint

      - name: Run tests
        run: yarn test --ci --watchAll=false
```

üëâ L·ª£i √≠ch:

- Khi b·∫°n t·∫°o Pull Request ‚Üí GitHub s·∫Ω ch·∫°y CI.
- Ch·ªâ khi pass CI ‚Üí m·ªõi merge v√†o main.
- Vercel sau ƒë√≥ deploy code ƒë√£ ƒë∆∞·ª£c ki·ªÉm ch·ª©ng.

## 3. K·∫øt qu·∫£ CI/CD

- Push l√™n nh√°nh feature: Vercel auto deploy Preview (d√πng ƒë·ªÉ QA/PM review).
- Merge v√†o main: Vercel auto deploy Production.
- Fail lint/test: Deploy b·ªã ch·∫∑n.
